# AuthService (–Ω–∞ Go)

–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:  
–°–µ—Ä–≤–∏—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ Go —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ `gin`. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±–∞–∑–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ access –∏ refresh —Ç–æ–∫–µ–Ω–∞–º, –∑–∞—â–∏—Ç—É –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, webhook-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é IP/User-Agent.

## üì¶ –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- Go 1.24
- Gin ‚Äî HTTP-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- PostgreSQL ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- JWT (github.com/golang-jwt/jwt/v5) ‚Äî –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ access-—Ç–æ–∫–µ–Ω–æ–≤
- bcrypt (golang.org/x/crypto/bcrypt) ‚Äî —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ refresh-—Ç–æ–∫–µ–Ω–æ–≤
- UUID (github.com/google/uuid) ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ç–æ–∫–µ–Ω–æ–≤
- Swag (github.com/swaggo/gin-swagger) ‚Äî –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è Swagger-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- Docker & Docker Compose ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –∏ –∑–∞–ø—É—Å–∫

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø—Ä–æ–≥—Ä–∞–º–º–µ

| –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ | –í—ã–ø–æ–ª–Ω–µ–Ω–æ |
|-----------|-----------|
| JWT access —Ç–æ–∫–µ–Ω —Ñ–æ—Ä–º–∞—Ç–∞ HS512 –±–µ–∑ —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î | ‚úÖ |
| Refresh —Ç–æ–∫–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –≤–∏–¥–µ bcrypt-—Ö—ç—à–∞ | ‚úÖ |
| Access/Refresh –≤—ã–¥–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –ø–∞—Ä–µ | ‚úÖ |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ User-Agent –ø—Ä–∏ refresh | ‚úÖ |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ IP –∏ webhook –ø—Ä–∏ refresh —Å –Ω–æ–≤–æ–≥–æ IP | ‚úÖ |
| –ó–∞—â–∏—Ç–∞ –¥–ª—è refresh —Ç–æ–∫–µ–Ω–æ–≤ | ‚úÖ |
| –ó–∞—â–∏—â—ë–Ω–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è GUID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | ‚úÖ |
| Logout (–¥–µ–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è) | ‚úÖ |
| Swagger-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ —Å—Ç–∞—Ç—É—Å–∞–º–∏ –∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏ | ‚úÖ |
| Docker Compose —Å –∑–∞–ø—É—Å–∫–æ–º –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π | ‚úÖ |

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```txt
authorization_go/
‚îú‚îÄ‚îÄ handlers/            # –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤
‚îú‚îÄ‚îÄ docs/                # Swagger-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ middleware/          # Middleware –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ 
‚îú‚îÄ‚îÄ models/              # –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö 
‚îú‚îÄ‚îÄ api_responses/       # –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ swagger
‚îú‚îÄ‚îÄ repositories/        # –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ services/            # JWT, refresh-—Ç–æ–∫–µ–Ω—ã, —É—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ main.go              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ —Ä–æ—É—Ç—ã
‚îú‚îÄ‚îÄ go.mod               # Go-–º–æ–¥—É–ª—å
‚îú‚îÄ‚îÄ docker-compose.yml   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker Compose
‚îî‚îÄ‚îÄ README.md            # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
```

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è PostgreSQL. –î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è `refresh` —Ç–æ–∫–µ–Ω–æ–≤ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ `refresh_tokens`.  
Access —Ç–æ–∫–µ–Ω—ã –Ω–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

### –¢–∞–±–ª–∏—Ü–∞ `refresh_tokens`

```sql
CREATE TABLE refresh_tokens (
    id UUID PRIMARY KEY,                  -- –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä refresh-—Ç–æ–∫–µ–Ω–∞
    user_id UUID NOT NULL,                -- GUID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    token_hash TEXT NOT NULL,             -- bcrypt-—Ö—ç—à refresh-—Ç–æ–∫–µ–Ω–∞
    user_agent TEXT NOT NULL,             -- User-Agent –∫–ª–∏–µ–Ω—Ç–∞
    ip_address TEXT NOT NULL,             -- IP-–∞–¥—Ä–µ—Å –∫–ª–∏–µ–Ω—Ç–∞
    expires_at TIMESTAMP NOT NULL,        -- –í—Ä–µ–º—è –∏—Å—Ç–µ—á–µ–Ω–∏—è —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–∫–µ–Ω–∞
    created_at TIMESTAMP NOT NULL,        -- –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏
    revoked_at TIMESTAMP NULL             -- –í—Ä–µ–º—è –æ—Ç–∑—ã–≤–∞ —Ç–æ–∫–µ–Ω–∞ (–º–æ–∂–µ—Ç –±—ã—Ç—å NULL)
);
```

## –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

```http
POST   /auth/generate                   # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä—ã access/refresh —Ç–æ–∫–µ–Ω–æ–≤
POST   /auth/refresh                    # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä—ã —Ç–æ–∫–µ–Ω–æ–≤
POST   /auth/revoke                     # –î–µ–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
GET    /auth/me                         # –ü–æ–ª—É—á–µ–Ω–∏–µ GUID —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (access required)
GET    /swagger/                        # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è swagger
```
## –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### 1. –°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone https://github.com/A737580/authorization_go.git
cd authorization_go
```
### 2. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose
```bash
docker-compose -f docker-compose.yml up -d
```
